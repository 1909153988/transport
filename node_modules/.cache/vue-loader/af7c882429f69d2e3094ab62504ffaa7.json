{"remainingRequest":"D:\\项目\\jusheng1\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\项目\\jusheng1\\src\\views\\basicdata\\enterprise\\index.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"D:\\项目\\jusheng1\\src\\views\\basicdata\\enterprise\\index.vue","mtime":1627990487433},{"path":"D:\\项目\\jusheng1\\node_modules\\@vue\\cli-service\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\项目\\jusheng1\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\项目\\jusheng1\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\项目\\jusheng1\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\项目\\jusheng1\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5hdmF0YXItdXBsb2FkZXIgLmVsLXVwbG9hZCB7CiAgYm9yZGVyOiAxcHggZGFzaGVkICNkOWQ5ZDk7CiAgYm9yZGVyLXJhZGl1czogNnB4OwogIGN1cnNvcjogcG9pbnRlcjsKICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgb3ZlcmZsb3c6IGhpZGRlbjsKfQoKLmF2YXRhci11cGxvYWRlciAuZWwtdXBsb2FkOmhvdmVyIHsKICBib3JkZXItY29sb3I6ICM0MDlFRkY7Cn0KCi5hdmF0YXItdXBsb2FkZXItaWNvbiB7CiAgZm9udC1zaXplOiAyOHB4OwogIGNvbG9yOiAjOGM5MzlkOwogIHdpZHRoOiAxNzhweDsKICBoZWlnaHQ6IDE3OHB4OwogIGxpbmUtaGVpZ2h0OiAxNzhweDsKICB0ZXh0LWFsaWduOiBjZW50ZXI7Cn0KCi5hdmF0YXIgewogIHdpZHRoOiAxNzhweDsKICBoZWlnaHQ6IDE3OHB4OwogIGRpc3BsYXk6IGJsb2NrOwp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsQA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/basicdata/enterprise","sourcesContent":["\n\n\n<template>\n  <div class=\"app-container\">\n\n    <el-tabs v-model=\"activeName\" type=\"border-card\" @tab-click=\"handleClick\">\n\n      <el-tab-pane label=\"个人认证信息\" name=\"third\">\n        <el-form ref=\"form\" :model=\"form\" label-width=\"160px\">\n          <el-row>\n            <el-col :span=\"6\">\n\n              <el-form-item label=\"身份证头像页\">\n                <el-upload\n                  class=\"avatar-uploader\"\n                  :show-file-list=\"false\"\n                  :auto-upload=\"false\"\n                  action=\"\"\n                  :on-change=\"uploadSectionFileB\">\n                  <img v-if=\"idCardPersonImageUrl\" :src=\"idCardPersonImageUrl\" class=\"avatar\">\n                  <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n                </el-upload>\n              </el-form-item>\n\n\n            </el-col>\n            <el-col :span=\"8\">\n\n              <el-form-item label=\"身份证国徽页\">\n                <el-upload\n                  class=\"avatar-uploader\"\n                  :show-file-list=\"false\"\n                  :auto-upload=\"false\"\n                  action=\"\"\n\n                  :on-change=\"uploadSectionFileC\">\n\n                  <img v-if=\"idCardBadgeImageUrl\" :src=\"idCardBadgeImageUrl\" class=\"avatar\">\n                  <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n\n                </el-upload>\n              </el-form-item>\n\n\n            </el-col>\n          </el-row>\n\n          <el-row>\n\n            <el-col :span=\"4\">\n              <el-form-item label=\"法定代表人姓名\" required>\n                <el-input id=\"legalPersonName\" v-model.trim=\"form.legalPersonName\"></el-input>\n              </el-form-item>\n            </el-col>\n\n\n            <el-col :span=\"20\">\n              <el-form-item required prop=\"\">\n                <div style=\"margin-left:40px\">请填写营业执照上面的法定代表人</div>\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n\n          <el-form-item label=\"法定代表人身份证号\" required>\n            <el-input id=\"idCardNumber\" v-model.trim=\"form.idCardNumber\"></el-input>\n          </el-form-item>\n\n\n          <el-row>\n            <el-col :span=\"4\">\n              <el-form-item label=\"法定代表人手机号\" required>\n                <el-input v-model.trim=\"form.contactPhone\"></el-input>\n              </el-form-item>\n            </el-col>\n\n            <el-col :span=\"20\">\n              <el-form-item required prop=\"\">\n                <div style=\"margin-left:40px\">请填写营业执照法定代表人的常用手机号</div>\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n\n          <div>\n            <el-form-item label=\" \">\n              <el-button type=\"primary\" @click=\"submitPersonForm('form')\" plain\n              >保存法人信息\n              </el-button\n              >\n            </el-form-item>\n          </div>\n        </el-form>\n      </el-tab-pane>\n\n\n\n      <el-tab-pane label=\"企业认证信息\" name=\"first\"  v-if=\"form.identity=='1'\">\n\n        <el-form ref=\"form\" :model=\"form\" label-width=\"140px\">\n          <el-row>\n            <el-col :span=\"4\">\n\n              <el-form-item label=\"营业执照\">\n                <el-upload\n                  class=\"avatar-uploader\"\n                  :show-file-list=\"false\"\n                  :auto-upload=\"false\"\n                  action=\"\"\n                  :on-change=\"uploadSectionFileA\">\n                  <img v-if=\"businessLicenseImageUrl\" :src=\"businessLicenseImageUrl\" class=\"avatar\">\n                  <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n                </el-upload>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"20\">\n              <el-form-item required prop=\"\">\n                <div>请上传营业执照照片，支持PNG、JPG、JPEG格式，大小不超过8M</div>\n              </el-form-item>\n            </el-col>\n          </el-row>\n          <el-row>\n            <el-col :span=\"4\">\n              <el-form-item label=\"企业名称\" required>\n                <el-input v-model=\"form.shipperFullName\"></el-input>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"20\">\n              <el-form-item required prop=\"\">\n                <div style=\"margin-left:40px\">企业名称需严格按照证件填写，在注册确认后不可更改</div>\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n          <el-row>\n            <el-col :span=\"8\">\n              <el-form-item label=\"企业简称\" required>\n                <el-input v-model=\"form.shipperShortName\"></el-input>\n              </el-form-item>\n              <el-form-item label=\"统一社会信用代码\" required>\n                <el-input v-model=\"form.societyCreditCode\"></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n          <el-row>\n            <el-col :span=\"4\">\n              <el-form-item label=\"法定代表人\" required>\n                <el-input v-model=\"form.businessPersonName\"></el-input>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"20\">\n              <el-form-item required prop=\"\">\n                <div style=\"margin-left:40px\">请填写营业执照上面的法定代表人</div>\n              </el-form-item>\n            </el-col>\n          </el-row>\n          <el-row>\n            <el-col :span=\"8\">\n              <el-form-item label=\"企业实际经营地\" required>\n                <el-input v-model=\"form.businessAddress\"></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n          <el-row>\n            <el-col :span=\"8\">\n              <el-form-item label=\"联系电话\">\n                <el-input v-model=\"form.businessContactPhone\"></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n          <div>\n            <el-form-item label=\" \">\n              <el-button type=\"primary\" @click=\"submitBusinessForm('form')\" plain\n              >保存企业信息\n              </el-button>\n            </el-form-item>\n          </div>\n        </el-form>\n\n\n      </el-tab-pane>\n      <el-tab-pane label=\"开票信息\" name=\"second\"  v-if=\"form.identity=='1'\">\n        <el-form ref=\"form\" :model=\"form\" label-width=\"140px\">\n          <el-row>\n            <el-col :span=\"8\">\n              <el-form-item label=\"发票抬头\" required prop=\"invoiceTitle\">\n                <el-input v-model=\"form.invoiceTitle\"></el-input>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"8\">\n              <el-form-item label=\"注册地址\" prop=\"registerAddress\">\n                <el-input v-model=\"form.registerAddress\"></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n          <el-row>\n            <el-col :span=\"8\">\n              <el-form-item label=\"纳税人识别号\" required prop=\"nashuiIdNumber\">\n                <el-input v-model=\"form.nashuiIdNumber\"></el-input>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"8\">\n              <el-form-item label=\"注册电话\" required prop=\"redisterPhone\">\n                <el-input v-model=\"form.redisterPhone\"></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n          <el-row>\n            <el-col :span=\"8\">\n              <el-form-item label=\"开户行\" required prop=\"kaihuBank\">\n                <el-input v-model=\"form.kaihuBank\"></el-input>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"8\">\n              <el-form-item label=\"开户账号\" required prop=\"accountBank\">\n                <el-input v-model=\"form.accountBank\"></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n          <el-row>\n            <el-col :span=\"8\">\n              <el-form-item label=\"发票收件人\" required prop=\"invoiceCollectName\">\n                <el-input v-model=\"form.invoiceCollectName\"></el-input>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"8\">\n              <el-form-item label=\"收件人电话\" required prop=\"invoiceCollectPhone\">\n                <el-input v-model=\"form.invoiceCollectPhone\"></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n          <el-row>\n            <el-col :span=\"8\">\n              <el-form-item label=\"发票收件地址\" required prop=\"invoiceCollectAddress\">\n                <el-input v-model=\"form.invoiceCollectAddress\"></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n          <div>\n            <el-form-item label=\" \">\n              <el-button type=\"primary\" @click=\"submitInvoiceForm('form')\" plain\n              >保存开票信息\n              </el-button\n              >\n              <!-- <el-button type=\"primary\" plain @click=\"next\">下一步</el-button> -->\n            </el-form-item>\n          </div>\n        </el-form>\n\n\n      </el-tab-pane>\n\n    </el-tabs>\n  </div>\n</template>\n<style>\n  .avatar-uploader .el-upload {\n    border: 1px dashed #d9d9d9;\n    border-radius: 6px;\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n  }\n\n  .avatar-uploader .el-upload:hover {\n    border-color: #409EFF;\n  }\n\n  .avatar-uploader-icon {\n    font-size: 28px;\n    color: #8c939d;\n    width: 178px;\n    height: 178px;\n    line-height: 178px;\n    text-align: center;\n  }\n\n  .avatar {\n    width: 178px;\n    height: 178px;\n    display: block;\n  }\n</style>\n<script>\n  import {\n    toUpdateCompanyAuth,\n    toUpdateCompanyInvoice,\n    toUpdatePersonalAuth,\n    toUploadPersonalIdCardFile,\n    toUserAuthInfo\n  } from \"@/api/client/userAuth\";\n\n  export default {\n    data() {\n      return {\n        activeName: 'third',\n        form: {},\n        businessLicenseImageUrl: '', //企业营业执照\n        idCardPersonImageUrl: '', //负责人身份证人像面\n        idCardBadgeImageUrl: '', //负责人身份证国徽面\n\n        businessLicenseImageFile: null,\n        idCardPersonImageFile: null,\n        idCardBadgeImageFile: null,\n\n        idcolor: '',\n\n\n      };\n    }, created() {\n      this.getUserAuthInfo();\n\n    },\n    methods: {\n\n      //查询认证信息\n\n      getUserAuthInfo() {\n        this.loading = true;\n        toUserAuthInfo().then(response => {\n\n          if (response != null && response.code === 200) {\n\n            const datas = response.data;\n            console.log(datas);\n\n            if (datas != null) {\n              const identity = datas.identity;\n              if (identity == '1') { //企业类型\n                console.log(\"企业类型\");\n\n                this.form = datas;\n                this.businessLicenseImageUrl = datas.businessLicense;\n                this.idCardPersonImageUrl = datas.idCardPerson;\n                this.idCardBadgeImageUrl = datas.idCardBadge;\n\n              } else if (identity == '0') { //个人\n                console.log(\"个人\");\n                this.form = datas;\n                this.idCardPersonImageUrl = datas.idCardPerson;\n                this.idCardBadgeImageUrl = datas.idCardBadge;\n              }\n\n            }\n\n\n          } else {\n            this.msgError(\"查询失败\");\n          }\n          this.loading = false;\n        });\n      },\n\n      //上传营业执照\n      uploadSectionFileA(file) {\n        this.uploadSectionFile(file, 1);\n      },\n\n      //身份证正面\n      uploadSectionFileB(file) {\n        this.uploadSectionFile(file, 2);\n\n      },\n\n      //身份证反面\n      uploadSectionFileC(file) {\n        this.uploadSectionFile(file, 3);\n\n      },\n\n      uploadSectionFile(file, type) {\n        const typeArr = ['image/png', 'image/gif', 'image/jpeg', 'image/jpg'];\n        const isJPG = typeArr.indexOf(file.raw.type) !== -1;\n        const isLt2M = file.size / 1024 / 1024 < 2;\n        if (!isJPG) {\n          this.msgError('上传图片只能是 png 、jpeg 、jpg  格式!');\n\n        }\n        if (!isLt2M) {\n          this.msgError('上传图片大小不能超过 2MB!');\n        }\n\n        if (type == 1) {\n          this.businessLicenseImageUrl = URL.createObjectURL(file.raw);\n          this.businessLicenseImageFile = file.raw; ////上传就用 this.imageFile\n        } else if (type == 2) {\n          this.idCardPersonImageUrl = URL.createObjectURL(file.raw);\n          this.idCardPersonImageFile = file.raw; ////上传就用 this.imageFile\n\n          this.idCardPersonOCR();\n        } else if (type == 3) {\n          this.idCardBadgeImageUrl = URL.createObjectURL(file.raw);\n          this.idCardBadgeImageFile = file.raw; ////上传就用 this.imageFile\n        }\n        return isJPG && isLt2M;\n      },\n\n      //身份证正面照 识别\n      idCardPersonOCR() {\n        let formData = new FormData();\n        formData.append(\"idCardFrontFile\", this.idCardPersonImageFile);\n\n        toUploadPersonalIdCardFile(formData).then(response => {\n\n\n          console.log(response);\n\n          if (response != null && response.code != null && response.code === 200) {\n\n            this.form.idCardNumber = response.idcard;\n\n            this.form.legalPersonName = response.name;\n\n            this.inputColor();\n\n          } else {\n\n          }\n\n        });\n\n      },\n\n      ////颜色\n      inputColor() {\n        var i = 3;\n        var idCardNumberInput = document.getElementById(\"idCardNumber\");\n        var legalPersonName = document.getElementById(\"legalPersonName\");\n        var interval = setInterval(function () {\n          legalPersonName.style.color = 'red';\n          idCardNumberInput.style.color = 'red';\n          setTimeout(function () {\n            idCardNumberInput.style.color = '';\n            legalPersonName.style.color = '';\n          }, 400)\n          i--;\n          if (i == 0) {\n            clearInterval(interval);\n            return false;\n          }\n        }, 500);\n      },\n\n\n      //保存企业信息\n      submitBusinessForm() {\n        const userIdChar = this.form.userIdChar;\n        const businessLicenseImageUrl = this.businessLicenseImageUrl;\n\n        const shipperFullName = this.form.shipperFullName;\n        const shipperShortName = this.form.shipperShortName;\n        const societyCreditCode = this.form.societyCreditCode;\n\n        const businessPersonName = this.form.businessPersonName;\n        const businessAddress = this.form.businessAddress;\n        const businessContactPhone = this.form.businessContactPhone;\n\n\n        if (userIdChar == undefined || userIdChar == null || userIdChar == \"\") {\n          this.msgError(\"信息异常\");\n          return;\n        }\n        if (businessLicenseImageUrl == undefined || businessLicenseImageUrl == null || businessLicenseImageUrl == \"\") {\n          this.msgError(\"请上传营业执照\");\n          return;\n        }\n\n\n        let formData = new FormData();\n        formData.append(\"businessLicenseFile\", this.businessLicenseImageFile);\n\n        formData.append(\"businessLicenseImageUrl\", businessLicenseImageUrl);\n\n        formData.append(\"shipperFullName\", shipperFullName);\n        formData.append(\"shipperShortName\", shipperShortName);\n        formData.append(\"societyCreditCode\", societyCreditCode);\n        formData.append(\"businessPersonName\", businessPersonName);\n        formData.append(\"businessAddress\", businessAddress);\n        formData.append(\"businessContactPhone\", businessContactPhone);\n\n        formData.append(\"userIdChar\", userIdChar);\n        this.loading = true;\n\n        toUpdateCompanyAuth(formData).then(response => {\n          if (response != null && response.code != null && response.code === 200) {\n            this.msgSuccess(response.msg);\n          } else {\n            this.msgError(response.msg);\n          }\n          this.loading = false;\n\n        });\n      },\n\n      //保存开票信息\n      submitInvoiceForm() {\n        const userIdChar = this.form.userIdChar;\n\n        if (userIdChar == undefined || userIdChar == null || userIdChar == \"\") {\n          this.msgError(\"信息异常\");\n          return;\n        }\n\n\n        let formData = {\n          userIdChar: userIdChar,\n          invoiceTitle: this.form.invoiceTitle,\n          registerAddress: this.form.registerAddress,\n          nashuiIdNumber: this.form.nashuiIdNumber,\n          redisterPhone: this.form.redisterPhone,\n          kaihuBank: this.form.kaihuBank,\n          accountBank: this.form.accountBank,\n          invoiceCollectName: this.form.invoiceCollectName,\n          invoiceCollectPhone: this.form.invoiceCollectPhone,\n          invoiceCollectAddress: this.form.invoiceCollectAddress\n        };\n\n        this.loading = true;\n\n        toUpdateCompanyInvoice(formData).then(response => {\n\n          if (response != null && response.code != null && response.code === 200) {\n            this.msgSuccess(response.msg);\n          } else {\n            this.msgError(response.msg);\n          }\n          this.loading = false;\n\n        });\n\n      },\n\n      //保存个人信息\n      submitPersonForm() {\n\n        const userIdChar = this.form.userIdChar;\n        const idCardPersonImageUrl = this.idCardPersonImageUrl;\n        const idCardBadgeImageUrl = this.idCardBadgeImageUrl;\n\n        const legalPersonName = this.form.legalPersonName;\n        const idCardNumber = this.form.idCardNumber;\n        const contactPhone = this.form.contactPhone;\n\n        if (userIdChar == undefined || userIdChar == null || userIdChar == \"\") {\n          this.msgError(\"信息异常\");\n          return;\n        }\n        if (idCardPersonImageUrl == undefined || idCardPersonImageUrl == null || idCardPersonImageUrl == \"\") {\n          this.msgError(\"请上传身份证正面照\");\n          return;\n        }\n        if (idCardBadgeImageUrl == undefined || idCardBadgeImageUrl == null || idCardBadgeImageUrl == \"\") {\n          this.msgError(\"请上传身份证反面照\");\n          return;\n        }\n        if (legalPersonName == undefined || legalPersonName == null || legalPersonName == \"\") {\n          this.msgError(\"请输入身份证姓名\");\n          return;\n        }\n        if (idCardNumber == undefined || idCardNumber == null || idCardNumber == \"\") {\n          this.msgError(\"请输入身份证号码\");\n          return;\n        }\n        if (contactPhone == undefined || contactPhone == null || contactPhone == \"\") {\n          this.msgError(\"请输入联系手机号\");\n          return;\n        }\n\n\n        let formData = new FormData();\n        formData.append(\"idCardFrontFile\", this.idCardPersonImageFile);\n        formData.append(\"idCardVersoFile\", this.idCardBadgeImageFile);\n\n        formData.append(\"idCardPersonImageUrl\", idCardPersonImageUrl);\n        formData.append(\"idCardBadgeImageUrl\", idCardBadgeImageUrl);\n\n        formData.append(\"name\", legalPersonName);\n        formData.append(\"idcard\", idCardNumber);\n        formData.append(\"phonenumber\", contactPhone);\n        formData.append(\"userIdChar\", userIdChar);\n        this.loading = true;\n\n\n        toUpdatePersonalAuth(formData).then(response => {\n          if (response != null && response.code != null && response.code === 200) {\n            this.msgSuccess(response.msg);\n          } else {\n            this.msgError(response.msg);\n          }\n          this.loading = false;\n\n        });\n\n      },\n\n\n      //标题切换事件\n      handleClick(tab, event) {\n        // console.log(tab, event);\n      }\n    },\n\n\n  };\n</script>\n\n"]}]}